1) какую-то херню с c=c1+1; and var c > 0;.
2) код задачи сразу после теории, код программы в конце в приложении. при обработке ошибок выводить кусок дерева(шима сказал херню).